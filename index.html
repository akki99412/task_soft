<html>
<script src="https://bossanova.uk/jspreadsheet/v4/jexcel.js"></script>
<script src="https://jsuites.net/v4/jsuites.js"></script>
<link rel="stylesheet" href="https://bossanova.uk/jspreadsheet/v4/jexcel.css" type="text/css" />
<link rel="stylesheet" href="https://jsuites.net/v4/jsuites.css" type="text/css" />
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Material+Icons" />






<link rel="stylesheet" type="text/css"
    href="http://weareoutman.github.io/clockpicker/dist/jquery-clockpicker.min.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="http://weareoutman.github.io/clockpicker/dist/jquery-clockpicker.min.js"></script>

<div id="spreadsheet"></div>

<script>
    var data = [
        ['<span>On his 11th birthday, <b>Harry</b> receives a letter inviting him to study magic at the Hogwarts School of Witchcraft and Wizardry. <b>Harry</b> discovers that not only is he a wizard, but he is a famous one. He meets two best friends, Ron Weasley and Hermione Granger, and makes his first enemy, Draco Malfoy.</span>','Jazz', 'Honda', '2019-02-12', '', true, '$ 2.000,00', '#777700'],
        ['Civic','Civic', 'Honda', '2018-07-11', '', true, '$ 4.000,01', '#007777', ,"10:11"],
    ];

    var clock_editor = {
        // Methods
        closeEditor: function (cell, save) {
            var value = cell.children[0].value;
            cell.innerHTML = value;
            return value;
        },
        openEditor: function (cell) {
            // Create input
            var element = document.createElement('input');
            element.value = cell.innerHTML;
            // Update cell
            cell.classList.add('editor');
            cell.innerHTML = '';
            cell.appendChild(element);
            $(element).clockpicker({
                afterHide: function () {
                    setTimeout(function () {
                        // To avoid double call
                        if (cell.children[0]) {
                            myTable.closeEditor(cell, true);
                        }
                    });
                }
            });
            // Focus on the element
            element.focus();
        },
        getValue: function (cell) {
            return cell.innerHTML;
        },
        setValue: function (cell, value) {
            cell.innerHTML = value;
        }
    }

            var data_template = [
                { header: "名前", member: "title", data_type: "string", table_type: "text", table_width: 200, table_num: 1, table_editor: null },
                { header: "ID", member: "id", data_type: "string", table_type: "text", table_width: 200, table_num: 2, table_editor: null },
                { header: "受領日", member: "receipt", data_type: "date", table_type: "calendar", table_width: 200, table_num: 3, table_editor: null },
                { header: "メモ", member: "memo", data_type: "string", table_type: "html", table_width: 200, table_num: 4, table_editor: null },
                { header: "タグ", member: "tag", data_type: "string", table_type: "text", table_width: 200, table_num: 5, table_editor: null },
                { header: "期限", member: "limit", data_type: "date", table_type: "calendar", table_width: 200, table_num: 6, table_editor: null },
                { header: "予定工数", member: "man_hours", data_type: "numeric", table_type: "numeric", table_width: 200, table_num: 7, table_editor: null },
                { header: "着手予定日時", member: "scheduled_date_time", data_type: "date", table_type: "hidden", table_width: 200, table_num: 8, table_editor: null },
                { header: "着手予定日", member: "scheduled_date", data_type: "function", table_type: "calendar", table_width: 200, table_num: 9, table_editor: null },
                { header: "着手予定時間", member: "scheduled_time", data_type: "function", table_type: "text", table_width: 200, table_num: 9, table_editor: clock_editor },
                { header: "完了予定日時", member: "completion_date_time", data_type: "date", table_type: "hidden", table_width: 200, table_num: 10, table_editor: null },
                { header: "完了予定日", member: "completion_date", data_type: "function", table_type: "calendar", table_width: 200, table_num: 11, table_editor: null },
                { header: "完了予定時間", member: "completion_time", data_type: "function", table_type: "text", table_width: 200, table_num: 12, table_editor: null },
                { header: "実際の実施日時", member: "implementation_date", data_type: "[date]", table_type: "html", table_width: 200, table_num: 13, table_editor: null },
                { header: "ステータス", member: "state", data_type: "STATE", table_type: "dropdown", table_width: 200, table_num: 14, table_editor: null },
                { header: "類似タスクid", member: "similar_tasks_id", data_type: "[string]", table_type: "hidden", table_width: 200, table_num: 15, table_editor: null },
                { header: "類似タスク", member: "similar_tasks", data_type: "function", table_type: "html", table_width: 200, table_num: 16, table_editor: null },
                { header: "後続タスクid", member: "successor_task_id", data_type: "[string]", table_type: "hidden", table_width: 200, table_num: 17, table_editor: null },
                { header: "後続タスク", member: "successor_task", data_type: "function", table_type: "html", table_width: 200, table_num: 18, table_editor: null },
                { header: "内包タスクid", member: "connotative_task_id", data_type: "[string]", table_type: "hidden", table_width: 200, table_num: 19, table_editor: null },
                { header: "内包タスク", member: "connotative_task", data_type: "function", table_type: "html", table_width: 200, table_num: 20, table_editor: null },
            ];

    
    jspreadsheet(document.getElementById('spreadsheet'), {
        data: data,
        columns: data_template.map(({ header, member, data_type , table_type, table_width, table_num, table_editor})=>({type:table_type, title:header, width: table_width, editor:table_editor})),
        
        // [
        //     { type: 'html', title: 'html_test', width: 120 , fadfadfadfs: "ssss"},
        //     { type: 'text', title: 'Car', width: 120 },
        //     { type: 'dropdown', title: 'Make', width: 200, source: ["Alfa Romeo", "Audi", "Bmw"] },
        //     { type: 'calendar', title: 'Available', width: 200 },
        //     { type: 'image', title: 'Photo', width: 120 },
        //     { type: 'checkbox', title: 'Stock', width: 80 },
        //     { type: 'numeric', title: 'Price', width: 100, mask: '$ #.##,00', decimal: ',' },
        //     { type: 'color', width: 100, render: 'square', }
        // ],
        minDimensions: [2, 2]
    });
</script>



</html>
